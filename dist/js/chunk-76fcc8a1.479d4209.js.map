{"version":3,"sources":["webpack:///./src/components/Me/setAvatar.vue?0ed9","webpack:///src/components/Me/setAvatar.vue","webpack:///./src/components/Me/setAvatar.vue?6df2","webpack:///./src/components/Me/setAvatar.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onClickLeft","_e","onSubmit","scopedSlots","_u","key","fn","afterRead","model","value","callback","$$v","fileList","expression","proxy","isSubmitting","_v","staticRenderFns","component"],"mappings":"wHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,gCAAgC,CAAEN,EAAgB,aAAEI,EAAG,SAAS,CAACA,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,uBAAuB,MAAQ,GAAG,aAAa,GAAG,YAAc,IAAIC,GAAG,CAAC,aAAaR,EAAIS,gBAAgB,GAAGT,EAAIU,KAAKN,EAAG,UAAU,CAACE,YAAY,aAAa,CAACF,EAAG,WAAW,CAACI,GAAG,CAAC,OAASR,EAAIW,WAAW,CAACP,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAW,MAAQ,SAASK,YAAYZ,EAAIa,GAAG,CAAC,CAACC,IAAI,QAAQC,GAAG,WAAW,MAAO,CAACX,EAAG,eAAe,CAACG,MAAM,CAAC,aAAaP,EAAIgB,UAAU,YAAY,GAAGC,MAAM,CAACC,MAAOlB,EAAY,SAAEmB,SAAS,SAAUC,GAAMpB,EAAIqB,SAASD,GAAKE,WAAW,gBAAgBC,OAAM,OAAUnB,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,aAAa,CAACE,YAAY,UAAUC,MAAM,CAAC,KAAO,UAAU,SAAWP,EAAIwB,aAAa,QAAUxB,EAAIwB,aAAa,eAAe,gBAAgB,cAAc,SAAS,MAAQ,KAAK,CAACxB,EAAIyB,GAAG,aAAa,IAAI,IAAI,GAAGrB,EAAG,SAAS,CAACE,YAAY,mBAC79BoB,EAAkB,G,YCuCtB,GAEA,KAFA,WAGA,OACA,UACA,YACA,YACA,kBAIA,QAXA,WAYA,sCAEA,UACA,aADA,WAEA,kBACA,SACA,qBAEA,SANA,WAOA,kCAGA,SACA,YADA,WAEA,qBAEA,UAJA,SAIA,cACA,qBACA,yBAEA,mBACA,0BACA,yBAEA,oCACA,gBADA,IAEA,SACA,gBACA,mBACA,kBACA,kBACA,uBAIA,SAvBA,WAuBA,WAEA,kBAEA,OADA,oCACA,EAGA,qBACA,gBACA,gCACA,sBACA,SACA,oCAEA,kBACA,mCACA,mBACA,wBCxGkW,I,YCO9VC,EAAY,eACd,EACA5B,EACA2B,GACA,EACA,KACA,KACA,MAIa,aAAAC,E","file":"js/chunk-76fcc8a1.479d4209.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"default-page set-avatar-page\"},[(_vm.isShowHeader)?_c('header',[_c('van-nav-bar',{attrs:{\"title\":\"Modify Head Portrait\",\"fixed\":\"\",\"left-arrow\":\"\",\"placeholder\":\"\"},on:{\"click-left\":_vm.onClickLeft}})],1):_vm._e(),_c('section',{staticClass:\"page-body\"},[_c('van-form',{on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"name\":\"uploader\",\"label\":\"Image\"},scopedSlots:_vm._u([{key:\"input\",fn:function(){return [_c('van-uploader',{attrs:{\"after-read\":_vm.afterRead,\"max-count\":1},model:{value:(_vm.fileList),callback:function ($$v) {_vm.fileList=$$v},expression:\"fileList\"}})]},proxy:true}])}),_c('div',{staticClass:\"vip-btn-wrap\"},[_c('van-button',{staticClass:\"vip-btn\",attrs:{\"type\":\"primary\",\"disabled\":_vm.isSubmitting,\"loading\":_vm.isSubmitting,\"loading-text\":\"Submitting...\",\"native-type\":\"submit\",\"block\":\"\"}},[_vm._v(\" Save \")])],1)],1)],1),_c('footer',{staticClass:\"page-footer\"})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<div class=\"default-page set-avatar-page\">\r\n\t\t<header v-if=\"isShowHeader\">\r\n\t\t\t<van-nav-bar\r\n\t\t\t\t\ttitle=\"Modify Head Portrait\"\r\n\t\t\t\t\tfixed\r\n\t\t\t\t\tleft-arrow\r\n\t\t\t\t\t@click-left=\"onClickLeft\"\r\n\t\t\t\t\tplaceholder\r\n\t\t\t></van-nav-bar>\r\n\t\t</header>\r\n\t\t<section class=\"page-body\">\r\n\t\t\t<van-form @submit=\"onSubmit\">\r\n\t\t\t\t<van-field name=\"uploader\" label=\"Image\">\r\n\t\t\t\t\t<template #input>\r\n\t\t\t\t\t\t<van-uploader v-model=\"fileList\" :after-read=\"afterRead\" :max-count=\"1\"/>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</van-field>\r\n\r\n\t\t\t\t<div class=\"vip-btn-wrap\">\r\n\t\t\t\t\t<van-button type=\"primary\" class=\"vip-btn\"\r\n\t\t\t\t\t\t\t\t:disabled=\"isSubmitting\"\r\n\t\t\t\t\t\t\t\t:loading=\"isSubmitting\"\r\n\t\t\t\t\t\t\t\tloading-text=\"Submitting...\"\r\n\t\t\t\t\t\t\t\tnative-type=\"submit\"\r\n\t\t\t\t\t\t\t\tblock>\r\n\t\t\t\t\t\tSave\r\n\t\t\t\t\t</van-button>\r\n\t\t\t\t</div>\r\n\t\t\t</van-form>\r\n\r\n\t\t</section>\r\n\t\t<footer class=\"page-footer\">\r\n\r\n\t\t</footer>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport { setUserInfo,uploadImage } from '@/api/user'\r\n\r\n\texport default {\r\n\r\n\t\tdata(){\r\n\t\t\treturn {\r\n\t\t\t\tavatar: '',\r\n\t\t\t\tavatarId: '',\r\n\t\t\t\tfileList: [],\r\n\t\t\t\tisSubmitting: false,\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcreated(){\r\n\t\t\tthis.avatar = this.userInfo.avatar || '';\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tisShowHeader() {\r\n\t\t\t\tconst route = this.$route\r\n\t\t\t\tconst { meta } = route\r\n\t\t\t\treturn meta.showHeader\r\n\t\t\t},\r\n\t\t\tuserInfo(){\r\n\t\t\t\treturn this.$store.getters.info\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonClickLeft() {\r\n\t\t\t\tthis.$router.go(-1);\r\n\t\t\t},\r\n\t\t\tafterRead(file){\r\n\t\t\t\tfile.status = 'uploading';\r\n\t\t\t\tfile.message = 'uploading...';\r\n\r\n\t\t\t\tlet param = new FormData();\r\n\t\t\t\tparam.append('type','avatar');\r\n\t\t\t\tparam.append('image',file.file);\r\n\r\n\t\t\t\tuploadImage(param).then(res=>{\r\n\t\t\t\t\tfile.status = 'done';\r\n\t\t\t\t\tconst { data } = res;\r\n\t\t\t\t\tthis.avatar = data.path;\r\n\t\t\t\t\tthis.avatarId = data.id;\r\n\t\t\t\t}).catch(()=>{\r\n\t\t\t\t\tfile.status = 'failed';\r\n\t\t\t\t\tfile.message = 'failed';\r\n\t\t\t\t});\r\n\r\n\t\t\t},\r\n\t\t\tonSubmit(){\r\n\r\n\t\t\t\tif(!this.avatarId){\r\n\t\t\t\t\tthis.$toast('Please select image');\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.isSubmitting = true;\r\n\t\t\t\tsetUserInfo({\r\n\t\t\t\t\tavatar_image_id: this.avatarId\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tconst { data } = res;\r\n\t\t\t\t\tthis.$store.dispatch('user/setInfo',data)\r\n\r\n\t\t\t\t\tthis.isSubmitting = false;\r\n\t\t\t\t\tthis.$toast('Submit successfully');\r\n\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\tthis.isSubmitting = false\r\n\t\t\t\t});\r\n\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t}\r\n</script>\r\n<style lang=\"=scss\">\r\n\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./setAvatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./setAvatar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./setAvatar.vue?vue&type=template&id=284b8ec2&\"\nimport script from \"./setAvatar.vue?vue&type=script&lang=js&\"\nexport * from \"./setAvatar.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}